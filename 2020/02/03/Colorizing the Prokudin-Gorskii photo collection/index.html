<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/blog/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/blog/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/blog/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/blog/images/logo.svg" color="#222">

<link rel="stylesheet" href="/blog/css/main.css">


<link rel="stylesheet" href="/blog/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"violetyao.github.io","root":"/blog/","scheme":"Muse","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="BackgroundBefore the 20th century, color photography had not yet become widespread - developments in the field were still rudimentary, at best. Sergei Mikhailovich Prokudin-Gorskii (1863-1944), a Russ">
<meta property="og:type" content="article">
<meta property="og:title" content="Colorizing the Prokudin-Gorskii Photo Collection">
<meta property="og:url" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="BackgroundBefore the 20th century, color photography had not yet become widespread - developments in the field were still rudimentary, at best. Sergei Mikhailovich Prokudin-Gorskii (1863-1944), a Russ">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/cathedral_3.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/cathedralnaive.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/cathedral.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/monastery.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/tobolsk.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/harvesters.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/icon.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/emir.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/lady.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/melons.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/night_camp.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/onion_church.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/self_portrait.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/three_generations.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/train.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/night_camp.jpg">
<meta property="og:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/australian.jpg">
<meta property="article:published_time" content="2020-02-04T05:31:05.645Z">
<meta property="article:modified_time" content="2020-05-21T04:30:36.552Z">
<meta property="article:author" content="Violet Yao">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/output/cathedral_3.jpg">

<link rel="canonical" href="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>Colorizing the Prokudin-Gorskii Photo Collection | Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/blog/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/blog/" rel="section"><i class="fa fa-fw fa-home"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/blog/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>Archives</a>

  </li>
  </ul>

</nav>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="en">
    <link itemprop="mainEntityOfPage" href="https://violetyao.github.io/blog/2020/02/03/Colorizing%20the%20Prokudin-Gorskii%20Photo%20Collection/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/blog/images/avatar.gif">
      <meta itemprop="name" content="Violet Yao">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Colorizing the Prokudin-Gorskii Photo Collection
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-02-03 21:31:05" itemprop="dateCreated datePublished" datetime="2020-02-03T21:31:05-08:00">2020-02-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-20 21:30:36" itemprop="dateModified" datetime="2020-05-20T21:30:36-07:00">2020-05-20</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="Background"><a href="#Background" class="headerlink" title="Background"></a>Background</h3><p>Before the 20th century, color photography had not yet become widespread - developments in the field were still rudimentary, at best. Sergei Mikhailovich Prokudin-Gorskii (1863-1944), a Russian photographer, was the one responsible for spearheading work in color photography with his implementation of the Three-color principle.</p>
<p>Starting in 1907, he traveled through the Russian Empire, documenting the vast landscapes in color for the first time. Over 10,000 pictures were taken in the form of RGB glass plate negatives, which have luckily survived the years.</p>
<p>An example of RGB example of glass plate image can be found here.</p>
<p><img src="output/cathedral_3.jpg" alt="Alt"></p>
<h3 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h3><p>In this project, I used image processing techniques to automatically colorize the glass plate images taken by Prokudin-Goskii.  In order to do this, I extracted the three color channel images, placed them on top of each other, and aligned them so that they form a single RGB color image.</p>
<h3 id="Approach"><a href="#Approach" class="headerlink" title="Approach"></a>Approach</h3><h4 id="Basic-Stacking"><a href="#Basic-Stacking" class="headerlink" title="Basic Stacking"></a>Basic Stacking</h4><p>A naive implementation is to place R, G, B on top of each other without aligning. Please find below an example output of naive implementation.</p>
<p><img src="output/cathedralnaive.jpg" alt="Alt"></p>
<p>It looks blury since R, G, B do not align well with each other.</p>
<h4 id="Exhaustive-Search"><a href="#Exhaustive-Search" class="headerlink" title="Exhaustive Search"></a>Exhaustive Search</h4><p>The easiest way to align the parts is to exhaustively search over a window of possible displacements. I use np.roll to test out how different displacements for images align with image2 (base). Specifically, I used two for loops iterating [-20, 20] possible displacements for x and y. Note that the window should not be too large for computational efficiency. I used SSD (Sum of Squared Differences) as the metrics to tell how well two images align. For each possible pair of x and y, I got their SSD align score. After all iterations are done, I chose the displaced image1 with lowest SSD score.  </p>
<p>I used one trick for better alignment - there are black borders for each channel. These borders does not contribute to how well two images align. Thus, I implemented a function crop images off their borders, which is called when calculating SSD sccores.</p>
<p>Outputs of exhaustive search can be found below:</p>
<table>
<thead>
<tr>
<th align="center">Green(2, 5) Red(3, 12)</th>
<th align="center">Green(2, -3), Red(2, 3)</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="output/cathedral.jpg" alt=""></td>
<td align="center"><img src="output/monastery.jpg" alt=""></td>
</tr>
</tbody></table>
<p>Green(3, 3) Red(3, 6)    |<br>:————————-:|:————————-:<br><img src="output/tobolsk.jpg" alt="">  |  </p>
<h3 id="Image-Pyramid-Aligment"><a href="#Image-Pyramid-Aligment" class="headerlink" title="Image Pyramid Aligment"></a>Image Pyramid Aligment</h3><p>For a (340, 390) image, it makes sense to just search in a small window of [-20, 20] to find the optimal displacement vector. However, for larger images, say [3400, 3900], possible displacements are very likely to exceeds [-20, 20] window. Thus, it is reasonable to make a larger window. However, it becomes computationally expensive.</p>
<p>Thus, an improvement should be made. I utilized a coarse-to-fine 7 layor pyramid search algorithm. The rescale factor starts from 1/pow(2,7) and times 2 during each recursion up. The pyramid search algorithm ended up using only ~30 sec to process a large tif high-res image.</p>
<p>Outputs of pyramid search can be found below:</p>
<table>
<thead>
<tr>
<th align="center">Green(16, 59) Red(13, 124)</th>
<th align="center">Green(17, 40) Red(23, 89)</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="output/harvesters.jpg" alt=""></td>
<td align="center"><img src="output/icon.jpg" alt=""></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">Green(24, 49) Red(-669, 163)</th>
<th align="center">Green(9, 48) Red(11, 112)</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="output/emir.jpg" alt=""></td>
<td align="center"><img src="output/lady.jpg" alt=""></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">Green(10, 82) Red(13, 179)</th>
<th align="center">Green(-5, 40) Red(-32, 108)</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="output/melons.jpg" alt=""></td>
<td align="center"><img src="output/night_camp.jpg" alt=""></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">Green(26, 51) Red(36, 108)</th>
<th align="center">Green(28, 78) Red(36, 176)</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="output/onion_church.jpg" alt=""></td>
<td align="center"><img src="output/self_portrait.jpg" alt=""></td>
</tr>
</tbody></table>
<table>
<thead>
<tr>
<th align="center">Green(14, 53) Red(11, 112)</th>
<th align="center">Green(5, 42) Red(31, 87)</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="output/three_generations.jpg" alt=""></td>
<td align="center"><img src="output/train.jpg" alt=""></td>
</tr>
</tbody></table>
<p>I found that emir.tif is not aligned well using pyramid search. Looking into that, I realized R has a different brightness from G and B, which causes the wrong alignment.</p>
<h3 id="Extra-Images"><a href="#Extra-Images" class="headerlink" title="Extra Images"></a>Extra Images</h3><table>
<thead>
<tr>
<th align="center">Green(-5, 40) Red(-32, 108)</th>
<th align="center">Green(8, 35) Red(17, 124)</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="output/night_camp.jpg" alt=""></td>
<td align="center"><img src="output/australian.jpg" alt=""></td>
</tr>
</tbody></table>

    </div>

    
    
    

      <footer class="post-footer">

        


        
    <div class="post-nav">
      <div class="post-nav-item"></div>
      <div class="post-nav-item">
    <a href="/blog/2020/02/17/Fun%20with%20Filters%20and%20Frequencies/" rel="next" title="Fun with Filters and Frequencies">
      Fun with Filters and Frequencies <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#Background"><span class="nav-number">1.</span> <span class="nav-text">Background</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Overview"><span class="nav-number">2.</span> <span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Approach"><span class="nav-number">3.</span> <span class="nav-text">Approach</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Basic-Stacking"><span class="nav-number">3.1.</span> <span class="nav-text">Basic Stacking</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Exhaustive-Search"><span class="nav-number">3.2.</span> <span class="nav-text">Exhaustive Search</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Image-Pyramid-Aligment"><span class="nav-number">4.</span> <span class="nav-text">Image Pyramid Aligment</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Extra-Images"><span class="nav-number">5.</span> <span class="nav-text">Extra Images</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Violet Yao</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/blog/archives/">
        
          <span class="site-state-item-count">8</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Violet Yao</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">Theme – <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/blog/lib/anime.min.js"></script>
  <script src="/blog/lib/velocity/velocity.min.js"></script>
  <script src="/blog/lib/velocity/velocity.ui.min.js"></script>

<script src="/blog/js/utils.js"></script>

<script src="/blog/js/motion.js"></script>


<script src="/blog/js/schemes/muse.js"></script>


<script src="/blog/js/next-boot.js"></script>




  















  

  

</body>
</html>
